---
import { getCollection, render } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import PostHeader from '../../components/post/post-header.astro';
import BackButton from '../../components/ui/back-button.vue';
import { sortByDate } from '../../utils/sortByDate.js';
// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
  const posts = await getCollection('blog');
  const numberOfPosts = posts.length; // Total of all posts
  return posts.sort(sortByDate).map((post, i) => ({
    params: { id: post.id },
    props: {
      post,
      // Previous post
      prevPost:
        i + 1 === numberOfPosts // If the current post is the oldest
          ? { frontmatter: '' }
          : posts[i + 1],
      // Next post
      nextPost:
        i === 0 // If the current post is the newest
          ? { frontmatter: '' }
          : posts[i - 1],
    },
  }));
}
// 2. For your template, you can get the entry directly from the prop
const { post, prevPost, nextPost } = Astro.props;
const { Content } = await render(post);
---

<Layout class=''>
  <article class='bg-neutral-50 w-full flex flex-col'>
    <PostHeader
      title={post.data.title}
      date={post.data.date}
      description={post.data.description ?? ''}
      author={post.data.author}
      image=''
    />
    <section
      class='bg-neutral-50 w-full z-10 pb-8 px-2 md:px-6 lg:py-20 rounded-t-4xl shadow-lg relative'>
      <div
        class='mx-auto prose max-w-4xl prose-zinc prose-sm md:prose-xl prose-p:font-medium prose-headings:font-medium prose-headings:tracking-tight'>
        <Content />
      </div>
      <nav
        class='max-w-4xl mx-auto py-5 mt-5 border-t border-neutral-300 grid grid-cols-2 gap-2 w-full'>
        <BackButton post={prevPost} />
        <BackButton post={nextPost} rotate />
      </nav>
    </section>
  </article>
</Layout>
